<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mily Alfajor - Card√°pio Digital</title>
  <meta name="description" content="Card√°pio digital da Mily Alfajor - Alfajores artesanais" />
  <link rel="stylesheet" href="style.css">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <header class="container">
    <img class="logo" src="LOGOMARCA.png" alt="Mily Alfajor - logo" />
    <h1>Mily Alfajor</h1>
    <div class="subtitle">Alfajores artesanais feitos com amor</div>
  </header>

  <main class="container">
    <div class="order-container">
      <section class="products-section">
        <h2 class="section-title">Nossos Sabores</h2>

        <div class="filter-row">
          <input type="text" id="filterName" placeholder="Filtrar por nome..." />
          <select id="filterPrice">
            <option value="all">Ordenar por pre√ßo</option>
            <option value="low">Menor pre√ßo</option>
            <option value="high">Maior pre√ßo</option>
          </select>
          <button class="btn secondary" id="resetFilters">Redefinir</button>
        </div>

        <ul class="product-list" id="productList">
          <li class="small">Carregando produtos...</li>
        </ul>
      </section>

      <section class="form-section">
        <h2 class="section-title">Seu Pedido</h2>

        <form id="pedidoForm">
          <div class="form-group">
            <label for="nome">Nome completo</label>
            <input type="text" id="nome" required />
          </div>

          <div class="form-group">
            <label for="telefone">Telefone</label>
            <input type="tel" id="telefone" required />
          </div>

          <div class="form-group">
            <label for="endereco">Endere√ßo completo</label>
            <textarea id="endereco" rows="2" required></textarea>
          </div>

          <div class="form-group">
            <label>Forma de pagamento</label>
            <label><input type="radio" name="pagamento" value="Pix" checked /> Pix</label>
            <label><input type="radio" name="pagamento" value="Dinheiro" /> Dinheiro</label>
            <label><input type="radio" name="pagamento" value="Cart√£o" /> Cart√£o</label>
          </div>

          <div class="form-group">
            <label for="observacoes">Observa√ß√µes</label>
            <textarea id="observacoes" rows="2"></textarea>
          </div>

          <div class="form-group">
            <label for="coupon">Cupom de desconto</label>
            <div class="coupon-row">
              <input type="text" id="coupon" placeholder="Insira o cupom" />
              <button type="button" class="btn secondary" id="applyCoupon">Aplicar</button>
            </div>
            <div id="couponMsg" class="small"></div>
          </div>

          <div class="total-section">
            <div class="total-label">Total do pedido</div>
            <div class="total-value">R$ <span id="total">0,00</span></div>
          </div>

          <div id="shopNotice" class="notice" style="display:none"></div>
          <div id="closedNotice" class="out-of-hours" style="display:none"></div>

          <div id="actionButtons" style="margin-top:12px;display:flex;gap:10px">
            <button type="button" id="viewSummary" class="btn">Ver resumo</button>
            <button type="submit" id="sendOrder" class="btn">Enviar pedido</button>
          </div>
        </form>
      </section>
    </div>
  </main>

  <footer class="container">
    <p>Mily Alfajor &copy; <span id="currentYear"></span></p>
  </footer>

  <!-- Modal resumo -->
  <div id="summaryModal" class="summary-modal">
    <div class="summary-card">
      <h3>Resumo do pedido</h3>
      <div id="summaryList"></div>
      <div id="summaryTotals" class="small"></div>
      <div id="modalButtons" style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
        <button id="closeSummary" class="btn secondary">Voltar</button>
        <button id="confirmSend" class="btn">Confirmar e enviar</button>
      </div>
    </div>
  </div>

<script>
// CONFIGURA√á√ïES
const horaAbertura = 9;
const horaFechamento = 22;
const whatsappNumber = '5524992438194';
const estoque = {
  'Brigadeiro': null, 'Beijinho': null, 'Doce de Leite': null,
  'Creme de Avel√£': null, 'Pistache': null, 'Oreo': 0, 'Kit Kat': 0
};
const produtos = [
  { id: 'Brigadeiro', name: 'Brigadeiro', price: 8.00, desc: 'Delicioso brigadeiro cremoso', img: 'fotos/BRIGADEIRO.png' },
  { id: 'Beijinho', name: 'Beijinho', price: 8.00, desc: 'Tradicional beijinho com coco', img: 'fotos/BEIJINHO.png' },
  { id: 'Doce de Leite', name: 'Doce de Leite', price: 9.00, desc: 'Doce de leite caseiro', img: 'fotos/DOCE DE LEITE 2.png' },
  { id: 'Creme de Avel√£', name: 'Creme de Avel√£', price: 9.00, desc: 'Creme de avel√£ premium', img: 'fotos/DOCE DE LEITE 1.png' },
  { id: 'Pistache', name: 'Pistache', price: 9.00, desc: 'Pistache com toque especial', img: 'fotos/PISTACHE.png' },
  { id: 'Oreo', name: 'Oreo', price: 9.00, desc: 'Oreo recheado', img: 'LOGOMARCA.png' },
  { id: 'Kit Kat', name: 'Kit Kat', price: 9.00, desc: 'Kit Kat crocante', img: 'LOGOMARCA.png' }
];
const cupons = { 'CUPOM10': 10 };
const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);
const formatCurrency = v => v.toFixed(2).replace('.', ',');
const state = { quantities: {}, appliedCoupon: null, discountPercent: 0 };

document.addEventListener('DOMContentLoaded', () => {
  $('#currentYear').textContent = new Date().getFullYear();
  produtos.forEach(p => state.quantities[p.id] = 0);
  renderProducts();
  checkOpenStatus();
  $('#applyCoupon').addEventListener('click', applyCoupon);
  $('#viewSummary').addEventListener('click', () => { renderSummary(); openSummary(); });
  $('#closeSummary').addEventListener('click', closeSummary);
  $('#pedidoForm').addEventListener('submit', e => { e.preventDefault(); renderSummary(); openSummary(); });
  $('#confirmSend').addEventListener('click', sendOrder);
});

function renderProducts() {
  const el = $('#productList');
  el.innerHTML = '';
  produtos.forEach(p => {
    const li = document.createElement('li');
    li.innerHTML = `<strong>${p.name}</strong> - R$ ${formatCurrency(p.price)}<br>${p.desc}
      <br><input type="number" min="0" data-id="${p.id}" value="0">`;
    el.appendChild(li);
  });
  $$('#productList input').forEach(inp => inp.addEventListener('input', e => {
    state.quantities[e.target.dataset.id] = parseInt(e.target.value) || 0;
    calculateTotal();
  }));
}

function calculateTotal() {
  let total = 0;
  produtos.forEach(p => total += (state.quantities[p.id] || 0) * p.price);
  total -= total * (state.discountPercent / 100);
  $('#total').textContent = formatCurrency(total);
}

function checkOpenStatus() {
  const hour = new Date().getHours();
  const open = horaAbertura <= horaFechamento
    ? (hour >= horaAbertura && hour < horaFechamento)
    : (hour >= horaAbertura || hour < horaFechamento);
  if (!open) {
    $('#closedNotice').style.display = 'block';
    $('#actionButtons').style.display = 'none';
    $('#modalButtons').style.display = 'none';
  } else {
    $('#closedNotice').style.display = 'none';
    $('#actionButtons').style.display = 'flex';
    $('#modalButtons').style.display = 'flex';
  }
}

function applyCoupon() {
  const code = $('#coupon').value.trim().toUpperCase();
  if (cupons[code]) {
    state.appliedCoupon = code;
    state.discountPercent = cupons[code];
    $('#couponMsg').textContent = `Cupom aplicado: ${code} (${cupons[code]}% desconto)`;
  } else {
    state.appliedCoupon = null;
    state.discountPercent = 0;
    $('#couponMsg').textContent = 'Cupom inv√°lido.';
  }
  calculateTotal();
}

function renderSummary() {
  const list = $('#summaryList');
  list.innerHTML = '';
  let total = 0;
  produtos.forEach(p => {
    const q = state.quantities[p.id] || 0;
    if (q > 0) {
      total += q * p.price;
      list.innerHTML += `‚Ä¢ ${p.name} ‚Äî ${q} un. ‚Äî R$ ${formatCurrency(q * p.price)}<br>`;
    }
  });
  list.innerHTML += `<br><strong>Total: R$ ${formatCurrency(total)}</strong>`;
}

function openSummary() { $('#summaryModal').style.display = 'flex'; }
function closeSummary() { $('#summaryModal').style.display = 'none'; }

function sendOrder() {
  const nome = $('#nome').value.trim();
  const telefone = $('#telefone').value.trim();
  const endereco = $('#endereco').value.trim();
  const pagamento = document.querySelector('input[name="pagamento"]:checked').value;
  const observacoes = $('#observacoes').value.trim();
  let msg = `*üì¶ NOVO PEDIDO - MILY ALFAJOR*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
  msg += `*üë§ Cliente:* ${nome}\n*üìû Telefone:* ${telefone}\n*üìç Endere√ßo:* ${endereco}\n*üí≥ Pagamento:* ${pagamento}\n`;
  if (observacoes) msg += `*üìù Observa√ß√µes:* ${observacoes}\n`;
  msg += `\n*üõí ITENS DO PEDIDO:*\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
  let total = 0;
  produtos.forEach(p => {
    const q = state.quantities[p.id] || 0;
    if (q > 0) {
      total += q * p.price;
      msg += `‚Ä¢ ${p.name} ‚Äî ${q} un. ‚Äî R$ ${formatCurrency(q * p.price)}\n`;
    }
  });
  if (state.appliedCoupon) msg += `\nüè∑ Cupom: ${state.appliedCoupon} (${state.discountPercent}%)\n`;
  msg += `\nüí∞ *TOTAL:* R$ ${formatCurrency(total - (total * (state.discountPercent / 100)))}\n‚úÖ Obrigado!`;
  window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`, '_blank');
}
</script>
</body>
</html>
